<html>
  <head>
    <style>
      * {
        box-sizing: border-box;
        position: absolute;
        margin: 0px;
      }
      #container {
        width: 960px;
        height: 540px;
        /* overflow: visible; */
        overflow: hidden;
        perspective: 900px;
        /* border: 1px solid black; */
      }
      #freezer {
        width: 960px;
        height: 540px;
        background-image: url('images/icebox.png');
        background-size: contain;
        background-repeat: no-repeat;
        animation: zoom-in-freezer 25s linear forwards;
      }
      #extras {
        width: 960px;
        height: 540px;
      }
      #t1 {
        top: 50%;
        transform: translate(150px, -50%);
      }
      #t2 {
        top: 50%;
        transform: translate(680px, -80%);
      }
      .heat-ripple {
        animation: ripple-fade 25s ease-in forwards;
      }
      #r1 {
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%) rotate(-45deg);
      }
      #heat-flow {
        font-family: Arial, Helvetica, sans-serif;
        font-size: 3em;
        top: 60%;
        left: 50%;
        transform: translate(-50%, -50%);
        opacity: 1;
        animation: heat-flow 6s linear forwards;
      }
      #cup-far {
        position: absolute;
        left: 0px;
        top: 0px;
        width: 960px;
        height: 540px;
        visibility: hidden;
        transform: rotateX(-5deg) translateY(10px);
        transform-style: preserve-3d;
        animation: zoom-in 25s linear forwards;
      }
      #cup-near {
        position: absolute;
        left: 0px;
        top: 0px;
        width: 960px;
        height: 540px;
        visibility: hidden;
        transform: rotateX(-5deg) translateY(10px);
        transform-style: preserve-3d;
        animation: zoom-in 25s linear forwards, dissapear 25s linear forwards;
      }
      #cup-far-bottom {
        top: 220px;
        left: 430px;
        width: 100px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform: rotateX(90deg) translate3D(0, -200px, -200px);
        clip-path: polygon(0 0, 100px 0, 100px 50px, 0 50px, 0 0);
      }
      #cup-far-bottom-upr {
        top: 225px;
        left: 435px;
        width: 90px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform: rotateX(90deg) translate3D(0, -200px, -190px);
        clip-path: polygon(0 0, 90px 0, 90px 45px, 0 45px, 0 0);
      }
      #cup-near-bottom {
        top: 220px;
        left: 430px;
        width: 100px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform: rotateX(90deg) translate3D(0, -200px, -200px);
        clip-path: polygon(0 50px, 100px 50px, 100px 100px, 0 100px, 0 50px);
      }
      #cup-near-bottom-upr {
        top: 225px;
        left: 435px;
        width: 90px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform: rotateX(90deg) translate3D(0, -200px, -190px);
        clip-path: polygon(0 45px, 90px 45px, 90px 90px, 0 90px, 0 45px);
      }
      #cup-far-lip {
        top: 215px;
        left: 425px;
        width: 110px;
        height: 110px;
        background: rgba(255,255,255,.6);
        transform: rotateX(90deg) translate3D(0, -200px, -100.1px);
        clip-path: polygon(0 0, 110px 0, 110px 55px, 104.5px 55px, 104.5px 5.5px, 5.5px 5.5px, 5.5px 55px, 0 55px, 0 0);
      }
      #cup-near-lip {
        top: 215px;
        left: 425px;
        width: 110px;
        height: 110px;
        background: rgba(255,255,255,.6);
        transform: rotateX(90deg) translate3D(0, -200px, -100.1px);
        clip-path: polygon(0 110px, 110px 110px, 110px 55px, 104.5px 55px, 104.5px 104.5px, 5.5px 104.5px, 5.5px 55px, 0 55px, 0 110px);
      }
      #cup-front {
        top: 370px;
        left: 425px;
        width: 110px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform-origin: 55px 100px;
        transform: translateZ(-150px) rotateX(-2.866deg);
        clip-path: polygon(0 0, 110px 0, 105px 100px, 5px 100px, 0 0);
      }
      #cup-front-inner {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform-origin: 49.5px 90px;
        transform: translateZ(-155px) rotateX(-2.866deg);
        clip-path: polygon(0 0, 99px 0, 94.5px 90px, 4.5px 90px, 0 0);
      }
      #cup-back {
        top: 370px;
        left: 425px;
        width: 110px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform-origin: 55px 100px;
        transform: translateZ(-250px) rotateX(2.866deg);
        clip-path: polygon(0 0, 110px 0, 105px 100px, 5px 100px, 0 0);
      }
      #cup-back-inner {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform-origin: 49.5px 90px;
        transform: translateZ(-245px) rotateX(2.866deg);
        clip-path: polygon(0 0, 99px 0, 94.5px 90px, 4.5px 90px, 0 0);
      }
      #cup-far-left {
        top: 370px;
        left: 425px;
        width: 110px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform-origin: 55px 100px;
        transform: rotateY(90deg) translateX(200px) translateZ(-50px) rotateX(2.866deg);
        clip-path: polygon(55px 0, 110px 0, 105px 100px, 55px 100px, 55px 0);
      }
      #cup-far-left-inner {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform-origin: 49.5px 90px;
        transform: rotateY(90deg) translateX(200px) translateZ(-45px) rotateX(2.866deg);
        clip-path: polygon(49.5px 0, 99px 0, 94.5px 90px, 49.5px 90px, 49.5px 0);
      }
      #cup-near-left {
        top: 370px;
        left: 425px;
        width: 110px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform-origin: 55px 100px;
        transform: rotateY(90deg) translateX(200px) translateZ(-50px) rotateX(2.866deg);
        clip-path: polygon(0 0, 55px 0, 55px 100px, 5px 100px, 0 0);
      }
      #cup-near-left-inner {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform-origin: 49.5px 90px;
        transform: rotateY(90deg) translateX(200px) translateZ(-45px) rotateX(2.866deg);
        clip-path: polygon(0 0, 49.5px 0, 49.5px 90px, 4.5px 90px, 0 0);
      }
      #cup-far-right {
        top: 370px;
        left: 425px;
        width: 110px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform-origin: 55px 100px;
        transform:rotateY(90deg)  translateX(200px) translateZ(50px) rotateX(-2.866deg);
        clip-path: polygon(55px 0, 110px 0, 105px 100px, 55px 100px, 55px 0);
      }
      #cup-far-right-inner {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform-origin: 49.5px 90px;
        transform:rotateY(90deg)  translateX(200px) translateZ(45px) rotateX(-2.866deg);
        clip-path: polygon(49.5px 0, 99px 0, 94.5px 90px, 49.5px 90px, 49.5px 0);
      }
      #cup-near-right {
        top: 370px;
        left: 425px;
        width: 110px;
        height: 100px;
        background: rgba(255,255,255,.6);
        transform-origin: 55px 100px;
        transform:rotateY(90deg)  translateX(200px) translateZ(50px) rotateX(-2.866deg);
        clip-path: polygon(0 0, 55px 0, 55px 100px, 5px 100px, 0 0);
      }
      #cup-near-right-inner {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(255,255,255,.6);
        transform-origin: 49.5px 90px;
        transform:rotateY(90deg)  translateX(200px) translateZ(45px) rotateX(-2.866deg);
        clip-path: polygon(0 0, 49.5px 0, 49.5px 90px, 4.5px 90px, 0 0);
      }
      #water-far-bottom {
        top: 225px;
        left: 434.9px;
        width: 90px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform: rotateX(90deg) translate3D(0, -200px, -190px);
        clip-path: polygon(0 0, 90px 0, 90px 45px, 0 45px, 0 0);
      }
      #water-near-bottom {
        top: 225px;
        left: 434.9px;
        width: 90px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform: rotateX(90deg) translate3D(0, -200px, -190px);
        clip-path: polygon(0 45px, 90px 45px, 90px 90px, 0 90px, 0 45px);
      }
      #water-front {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform-origin: 49.5px 90px;
        transform: translateZ(-155px) rotateX(-2.866deg);
        clip-path: polygon(0.5px 10px, 98.5px 10px, 94.5px 90px, 4.5px 90px, 0.5px 10px);
      }
      #water-back {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform-origin: 49.5px 90px;
        transform: translateZ(-245px) rotateX(2.866deg);
        clip-path: polygon(0.5px 10px, 98.5px 10px, 94.5px 90px, 4.5px 90px, 0.5px 10px);
      }
      #water-far-left {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform-origin: 49.5px 90px;
        transform: rotateY(90deg) translateX(200px) translateZ(-45px) rotateX(2.866deg);
        clip-path: polygon(49.5px 10px, 98.5px 10px, 94.5px 90px, 49.5px 90px, 49.5px 10px);
      }
      #water-near-left {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform-origin: 49.5px 90px;
        transform: rotateY(90deg) translateX(200px) translateZ(-45px) rotateX(2.866deg);
        clip-path: polygon(0.5px 10px, 49.5px 10px, 49.5px 90px, 4.5px 90px, 0.5px 10px);
      }
      #water-far-right {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform-origin: 49.5px 90px;
        transform:rotateY(90deg)  translateX(200px) translateZ(44.9px) rotateX(-2.866deg);
        clip-path: polygon(49.5px 10px, 98.5px 10px, 94.5px 90px, 49.5px 90px, 49.5px 10px);
      }
      #water-near-right {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        background: rgba(0,0,255,.3);
        transform-origin: 49.5px 90px;
        transform:rotateY(90deg)  translateX(200px) translateZ(44.9px) rotateX(-2.866deg);
        clip-path: polygon(0.5px 10px, 49.5px 10px, 49.5px 90px, 4.5px 90px, 0.5px 10px);
      }
      #water-far-top {
        top: 221px;
        left: 430.9px;
        width: 98px;
        height: 98px;
        background: rgba(0,0,255,.3);
        transform: rotateX(90deg) translate3D(0, -200px, -110px);
        clip-path: polygon(0 0, 98px 0, 98px 49px, 0 49px, 0 0);
      }
      #water-near-top {
        top: 221px;
        left: 430.9px;
        width: 98px;
        height: 98px;
        background: rgba(0,0,255,.3);
        transform: rotateX(90deg) translate3D(0, -200px, -110px);
        clip-path: polygon(0 49px, 98px 49px, 98px 98px, 0 98px, 0 49px);
      }
      #water-csec {
        top: 370px;
        left: 430.5px;
        width: 99px;
        height: 90px;
        transform-origin: 49.5px 90px;
        transform: translateZ(-200px);
        opacity: 1;
      }
      @keyframes ripple-fade {
        to {
          opacity: 0;
        }
      }
      @keyframes heat-flow {
        80% {
          opacity: 0;
        }
        100% {
          opacity: 0;
        }
      }
      @keyframes equilibrium {
        80% {
          opacity: 0;
        }
        100% {
          opacity: 1;
        }
      }
      @keyframes zoom-in {
        12% { visibility: hidden; }
        20% { visibility: visible; }
        88% { transform: translate3D(0, 0, 0); }
        to { 
          visibility: visible;
          transform: translate3D(0, -150px, 700px);
        }
      }
      @keyframes zoom-in-freezer {
        88% { transform: translate3D(0, 0, 0); }
        to { transform: scale(190%) translateY(-100px); }
      }
      @keyframes dissapear {
        12% { visibility: hidden; }
        20% { visibility: visible; }
        88% { visibility: visible; }
        to { visibility: hidden; }
      }
    </style>
  </head>
  <body>
    <div id='container'>
      <div id='freezer'>
      </div>
      <div id='extras'>
        <canvas class='thermometer' id='t1'></canvas>
        <canvas class='heat-ripple' id='r1'></canvas>
        <canvas class='thermometer' id='t2'></canvas>
      </div>
      <div id="cup-far">
        <div id="cup-far-bottom"></div>
        <div id="cup-far-bottom-upr"></div>
        <div id="cup-far-lip"></div>
        <div id="cup-back"></div>
        <div id="cup-back-inner"></div>
        <div id="cup-far-left"></div>
        <div id="cup-far-left-inner"></div>
        <div id="cup-far-right"></div>
        <div id="cup-far-right-inner"></div>
        <div id="water-far-bottom"></div>
        <div id="water-back"></div>
        <div id="water-far-left"></div>
        <div id="water-far-right"></div>
        <div id="water-far-top"></div>
        <canvas id='water-csec'></canvas>
      </div>
      <div id="cup-near">
        <div id="cup-near-bottom"></div>
        <div id="cup-near-bottom-upr"></div>
        <div id="cup-near-lip"></div>
        <div id="cup-front"></div>
        <div id="cup-front-inner"></div>
        <div id="cup-near-left"></div>
        <div id="cup-near-left-inner"></div>
        <div id="cup-near-right"></div>
        <div id="cup-near-right-inner"></div>
        <div id="water-near-bottom"></div>
        <div id="water-front"></div>
        <div id="water-near-left"></div>
        <div id="water-near-right"></div>
        <div id="water-near-top"></div>
      </div>
    </div>
    <script src='js/thermometer.js'></script>
    <script src='js/heat-ripple.js'></script>
    <script>
      // const heatRipple = (  rippleId = 'r1',
      //   rippleWidth = 200, rippleHeight = 20,
      //   lineThickness = 3, ripplePeriod = 40, rippleSpeed = 50,
      //   startColor = 'red', endColor = 'yellow') => {
      heatRipple('r1', 100, 10, 2, 20, 100);
      // const thermometer = (id = 't0',
      //   change = 'cooling'|'heating'|'cold'|'hot',
      //   animationTime = 5
      //   canvasWidth = 50, canvasHeight = 200, 
      //   bulbDia = 40, shaftDia = 20,
      //   outlineThickness = 3, columnTopRange = [30, 125], delay(ms)) => {

      // thermometer('t1', 'cooling', 5, 37, 150, 30, 15, 2, [22, 90]);
      // thermometer('t2', 'cold', 5, 37, 150, 30, 15, 2, [22, 90]);

      const waterCsec = document.getElementById('water-csec');
      waterCsec.width = 99;
      waterCsec.height = 90;
      const ctxWater = waterCsec.getContext('2d');
    
      let particleSpeed = 5;
      const animationTime = 35;
      const particleLoc = [];
      const numParticles = 10;
      const particleDia = 5;
      const gradient = ctxWater.createRadialGradient(49.5, 50, 20, 49.5, 50, 65);

      let startTime = Date.now() + 25000;
      const drawWater = () => {
        ctxWater.clearRect(0, 0, 99, 90)
        const elapsedTimeSec = (Date.now() - startTime) / 1000;
        const fracRemaining =
          elapsedTimeSec / animationTime < 1 ?
          1 - elapsedTimeSec / animationTime : 0;
    
        ctxWater.beginPath();
        ctxWater.moveTo(0.5, 10);
        ctxWater.lineTo(98.5, 10);
        ctxWater.lineTo(94.5, 90);
        ctxWater.lineTo(4.5, 90);
        ctxWater.lineTo(0.5, 10);

        ctxWater.fillStyle = 'rgba(0,0,255,.3)';
        ctxWater.fill();

        gradient.addColorStop(0, 'rgba(170, 212, 229, 0)');
        // gradient.addColorStop(fracRemaining, 'rgba(170, 212, 229, 0)');
        gradient.addColorStop(fracRemaining + 0.1 > 1 ? 1 : fracRemaining + 0.1,
          'rgba(170, 212, 229, 255)');
        gradient.addColorStop(1, 'rgba(170, 212, 229, 255)');
      
        ctxWater.fillStyle = gradient;
        ctxWater.fill();
    
        // ctxWater.beginPath();
        // ctxWater.moveTo((canvasWidth - shaftDia) / 2, 0.8 * canvasHeight);
        // ctxWater.lineTo((canvasWidth - shaftDia) / 2, canvasWidth / 2);
        // ctxWater.arc(canvasWidth / 2, canvasWidth / 2, shaftDia / 2, Math.PI, 0);
        // ctxWater.lineTo((canvasWidth + shaftDia) / 2, 0.8 * canvasHeight);
        // ctxWater.fill();
        // ctxWater.stroke();
    
        // let colTop;
        // switch (change) {
        //   case 'cooling':
        //     ctxWater.fillStyle =
        //       'rgb(' + 255 * (1 - elapsedFrac) + ', 0, ' + 255 * elapsedFrac;
        //     colTop =
        //       columnTopRange[0] * (1 - elapsedFrac) +
        //       columnTopRange[1] * elapsedFrac;
        //     break;
        //   case 'heating':
        //     ctxWater.fillStyle =
        //       'rgb(' + 255 * elapsedFrac + ', 0, ' + 255 * (1 - elapsedFrac);
        //     colTop =
        //       columnTopRange[0] * elapsedFrac +
        //       columnTopRange[1] * (1 - elapsedFrac);
        //     break;
        //   case 'hot':
        //     ctxWater.fillStyle = 'red';
        //     colTop = columnTopRange[0];
        //     break;
        //   case 'cold':
        //   default:
        //     ctxWater.fillStyle = 'blue';
        //     colTop = columnTopRange[1];
        // }
        // let colHeight = canvasHeight - canvasWidth / 2 - colTop;
    
        // ctxWater.beginPath();
        // ctxWater.arc(
        //   canvasWidth / 2,
        //   canvasHeight - canvasWidth / 2,
        //   bulbDia / 2,
        //   0,
        //   2 * Math.PI
        // );
        // ctxWater.fill();
        // ctxWater.stroke();
    
        // ctxWater.beginPath();
        // ctxWater.fillRect(
        //   (canvasWidth - shaftDia + outlineThickness) / 2,
        //   colTop,
        //   shaftDia - outlineThickness,
        //   colHeight
        // );
        // ctxWater.fill();

        if (fracRemaining > 0) {
          window.requestAnimationFrame(drawWater);
        }
      }

      setTimeout(drawWater, 25000);
    </script>
  </body>
</html>
